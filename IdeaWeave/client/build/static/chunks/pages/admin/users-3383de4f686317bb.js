(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9635],{38153:function(e,i,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/users",function(){return t(85218)}])},49923:function(e,i,t){"use strict";var s=t(85893),l=t(67294),n=t(11163),a=t(4851);i.Z=e=>{let{path:i="/"}=e,[t,r]=(0,l.useState)(3),d=(0,n.useRouter)();return(0,l.useEffect)(()=>{let e=setInterval(()=>{r(t-1)},1e3);return 0===t&&(clearInterval(e),d.push(i)),()=>clearInterval(e)},[t]),(0,s.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:(0,s.jsx)(a.default,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",fontSize:"50px",color:"red"}})})}},22631:function(e,i,t){"use strict";t.d(i,{Z:function(){return N}});var s=t(85893),l=t(67294),n=t(16373),a=t(12386),r=t(41664),d=t.n(r),c=t(9470),o=t(26401),u=t(5099),m=t(35741),h=t(65772),f=t(46403),x=t(63521),v=t(27478),b=t(42074),g=t(42567);let{SubMenu:p}=a.default,{Sider:j}=n.default;var y=()=>{var e,i,t,n;let[r,y]=(0,l.useState)(""),[w,k]=(0,l.useState)(""),[A,I]=(0,l.useContext)(b.V),[N]=(0,l.useContext)(g.N),[C,S]=(0,l.useState)(!1),_=()=>{S(window.innerWidth<1e3)};(0,l.useEffect)(()=>{y(window.location.pathname);let e=window.location.pathname.split("/");return e.length>=3?k("/".concat(e[1])):k(""),window.addEventListener("resize",_),()=>{window.removeEventListener("resize",_)}},[]),(0,l.useEffect)(()=>{_()},[]);let z={sider:{width:C?50:100,transition:"width 0.3s cubic-bezier(0.645, 0.045, 0.355, 1)",overflow:"hidden",paddingTop:"64px",height:"100vh"},fixedSider:{position:"fixed",top:0,left:0,bottom:0,zIndex:1e3,background:"dark"===N?"#001529":"#fff",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.1)"},menu:{background:"dark"===N?"#001529":"#fff",height:"calc(100% - 64px)",overflowY:"auto",overflowX:"hidden",scrollbarWidth:"thin",WebkitOverflowScrolling:"touch"},item:{background:"transparent",transition:"background 0.3s"},activeItem:{background:"dark"===N?"#007F7F":"#00BFFF",color:"#fff"},activeSubMenu:{background:"dark"===N?"#007F7F":"#00BFFF",color:"#fff",transition:"width 0.3s cubic-bezier(0.645, 0.045, 0.355, 1) 0.1s"}};return(0,s.jsx)(j,{collapsible:!0,collapsed:C,onCollapse:()=>S(!C),style:{...z.sider,...z.fixedSider},children:(0,s.jsxs)(a.default,{defaultOpenKeys:["2","6","10"],mode:"inline",inlineCollapsed:C,selectedKeys:[r],style:z.menu,theme:N,children:[(0,s.jsx)(a.default.Item,{icon:(0,s.jsx)(m.Z,{}),className:"/admin"===r?"active":"",style:"/admin"===r?z.activeItem:z.item,children:(0,s.jsx)(d(),{href:"/admin",children:"Dashboard"})},"/admin"),(0,s.jsx)(a.default.Item,{icon:(0,s.jsx)(v.Z,{}),className:"/admin/library"===r?"active":"",style:"/admin/library"===r?z.activeItem:z.item,children:(0,s.jsx)(d(),{href:"/admin/library",children:"Library"})},"/admin/library"),(0,s.jsxs)(p,{icon:(0,s.jsx)(c.Z,{}),title:"Posts",className:"/admin"===w?"active":"",style:"/admin"===w?z.activeSubMenu:{},children:[(0,s.jsx)(a.default.Item,{className:"/admin/posts"===r?"active":"",style:"/admin/posts"===r?z.activeItem:z.item,children:(0,s.jsx)(d(),{href:"/admin/posts",children:"All Books"})},"/admin/posts"),(0,s.jsx)(a.default.Item,{className:"/admin/posts/drafts"===r?"active":"",style:"/admin/posts/drafts"===r?z.activeItem:z.item,children:(0,s.jsx)(d(),{href:"/admin/posts/drafts",children:"All Drafts"})},"/admin/drafts"),(0,s.jsx)(a.default.Item,{className:"/admin/posts/new"===r?"active":"",style:"/admin/posts/new"===r?z.activeItem:z.item,children:(0,s.jsx)(d(),{href:"/admin/posts/new",children:"Add New Book"})},"/admin/posts/new"),(0,s.jsx)(a.default.Item,{className:"/admin/categories"===r?"active":"",style:"/admin/categories"===r?z.activeItem:z.item,children:(0,s.jsx)(d(),{href:"/admin/categories",children:"Categories"})},"/admin/categories")]},"2"),(0,s.jsxs)(p,{icon:(0,s.jsx)(o.Z,{}),title:"Media",children:[(0,s.jsx)(a.default.Item,{className:"/admin/media/library"===r?"active":"",style:"/admin/media/library"===r?z.activeItem:z.item,children:(0,s.jsx)(d(),{href:"/admin/media/library",children:"Media Library"})},"/admin/media/library"),(0,s.jsx)(a.default.Item,{className:"/admin/media/new"===r?"active":"",style:"/admin/media/new"===r?z.activeItem:z.item,children:(0,s.jsx)(d(),{href:"/admin/media/new",children:"Add New Media"})},"/admin/media/new")]},"6"),(0,s.jsx)(a.default.Item,{icon:(0,s.jsx)(x.Z,{}),className:"/admin/comments"===r?"active":"",style:"/admin/comments"===r?z.activeItem:z.item,children:(0,s.jsx)(d(),{href:"/admin/comments",children:"Comments"})},"/admin/comments"),(0,s.jsxs)(p,{icon:(0,s.jsx)(u.Z,{}),title:"Users",children:[(0,s.jsx)(a.default.Item,{className:"/admin/users"===r?"active":"",style:"/admin/users"===r?z.activeItem:z.item,children:(0,s.jsx)(d(),{href:"/admin/users",children:"All Users"})},"/admin/users"),(0,s.jsx)(a.default.Item,{className:"/admin/users/new"===r?"active":"",style:"/admin/users/new"===r?z.activeItem:z.item,children:(0,s.jsx)(d(),{href:"/admin/users/new",children:"Add New"})},"/admin/users/new")]},"10"),(0,s.jsx)(a.default.Item,{icon:(0,s.jsx)(f.Z,{}),className:r==="/admin/".concat(null==A?void 0:null===(e=A.user)||void 0===e?void 0:e._id)?"active":"",style:r==="/admin/".concat(null==A?void 0:null===(i=A.user)||void 0===i?void 0:i._id)?z.activeItem:z.item,children:(0,s.jsx)(d(),{href:"/admin/".concat(null==A?void 0:null===(t=A.user)||void 0===t?void 0:t._id),id:"profile",children:"Profile"})},"/admin/".concat(null==A?void 0:null===(n=A.user)||void 0===n?void 0:n._id)),(0,s.jsx)(a.default.Item,{icon:(0,s.jsx)(h.Z,{}),className:"/admin/customize"===r?"active":"",style:"/admin/customize"===r?z.activeItem:z.item,children:(0,s.jsx)(d(),{href:"/admin/customize",children:"Customize"})},"/admin/customize")]})})},w=t(11163),k=t(6154),A=t(49923);let{Content:I}=n.default;function N(e){let{children:i}=e,[t,a]=(0,l.useContext)(b.V),[r,d]=(0,l.useState)(!0),[c,o]=(0,l.useState)(!0),u=(0,w.useRouter)();(0,l.useEffect)(()=>{(null==t?void 0:t.token)&&m()},[null==t?void 0:t.token]);let m=async()=>{try{let{data:e}=await k.Z.get("/current-admin");d(!1)}catch(e){console.log(e),u.push("/")}};return r?(0,s.jsx)(A.Z,{}):(0,s.jsxs)(n.default,{children:[(0,s.jsx)(y,{isOpen:c,toggleNav:()=>{o(!c)}}),(0,s.jsx)(n.default,{style:{marginLeft:c?90:80,transition:"margin 0.5s"},children:(0,s.jsx)(I,{style:{padding:"10px"},children:i})})]})}},85218:function(e,i,t){"use strict";t.r(i),t.d(i,{default:function(){return S}});var s=t(85893),l=t(48848),n=t.n(l),a=t(67294),r=t(55673),d=t(5789),c=t(70302),o=t(56590),u=t(84960),m=t(65400),h=t(89552),f=t(69843),x=t(59361),v=t(53740),b=t(84996),g=t(51024),p=t(64749),j=t(86501),y=t(11163),w=t(42074),k=t(6154),A=t(22631),I=t(42567);let{Search:N}=g.default,{Option:C}=p.default;function S(){let[e,i]=(0,a.useContext)(w.V),t=(0,y.useRouter)(),[l,g]=(0,a.useState)([]),[S,_]=(0,a.useState)(!1),[z]=(0,a.useContext)(I.N),[R,E]=(0,a.useState)(1),[Z,L]=(0,a.useState)(0),[F,T]=(0,a.useState)({searchTerm:"",role:"",isActive:null}),[U,B]=(0,a.useState)({field:"name",order:"asc"});(0,a.useEffect)(()=>{(null==e?void 0:e.token)&&D()},[null==e?void 0:e.token,F,U]);let D=async()=>{try{_(!0);let{data:e}=await k.Z.get("/users");g(W(e,F,U))}catch(e){console.error(e)}finally{_(!1)}},W=(e,i,t)=>{let s=e;if(i.searchTerm){let e=i.searchTerm.toLowerCase();s=s.filter(i=>i.email.toLowerCase().includes(e)||i.name.toLowerCase().includes(e)||i.role.toLowerCase().includes(e))}i.role&&(s=s.filter(e=>e.role===i.role)),null!==i.isActive&&(s=s.filter(e=>e.isActive===i.isActive));let l=t.field,n="asc"===t.order?1:-1;return s.sort((e,i)=>e[l]<i[l]?-1*n:e[l]>i[l]?1*n:0),s},M=async i=>{if(!i.isUpdating)try{if(i._id===e.user._id){j.Am.error("You cannot toggle your own status");return}g(e=>e.map(e=>e._id===i._id?{...e,isUpdating:!0}:e));try{let{data:e}=await k.Z.put("/users/".concat(i._id,"/toggle"));g(t=>t.map(t=>t._id===i._id?{...t,isActive:e.isActive,isUpdating:!1}:t)),j.Am.success("User ".concat(e.isActive?"enabled":"disabled"," successfully"))}catch(e){console.error(e),g(e=>e.map(e=>e._id===i._id?{...e,isUpdating:!1}:e))}}catch(e){console.error(e)}},O=e=>{t.push("/admin/users/".concat(e))};(0,a.useEffect)(()=>{let e=()=>{L(window.innerWidth)};return window.addEventListener("resize",e),L(window.innerWidth),()=>{window.removeEventListener("resize",e)}},[]);let P=(e,i)=>{let t=(R-1)*5,l=t+5,n=i.slice(t,l);return(0,s.jsxs)(c.default,{title:e,style:{marginBottom:20,borderRadius:10,backgroundColor:"dark"===z?"#333":"#f0f2f5",color:"dark"===z?"white":"black"},children:[(0,s.jsx)(o.default,{itemLayout:"horizontal",dataSource:n,renderItem:e=>{var i,t,l;return(0,s.jsxs)(o.default.Item,{className:e.isActive?"active-user":"disabled-user",style:{border:"1px solid ".concat("dark"===z?"#444":"#ddd"),borderRadius:8,marginBottom:12,padding:16},children:[(0,s.jsx)(o.default.Item.Meta,{avatar:(0,s.jsx)(u.ZP,{src:null==e?void 0:null===(i=e.image)||void 0===i?void 0:i.url,style:{backgroundColor:"#87d068"},children:(null==e?void 0:e.name)?e.name[0]:""}),title:(0,s.jsxs)("div",{children:[e.name," ",(0,s.jsx)(x.Z,{color:e.isActive?"green":"red",children:e.isActive?"Active":"Disabled"})]}),description:(0,s.jsxs)("div",{style:{maxWidth:"80%"},children:[Z>576?e.email:e.email.replace(/^(.{2})(.*)(?=@)/,(e,i,t)=>"".concat(i,"...")),("Admin"===e.role||"Author"===e.role)&&(0,s.jsxs)("div",{className:"posts-info",children:[(0,s.jsx)(v.default.Text,{strong:!0,children:"Posts:"})," ",(null==e?void 0:null===(t=e.posts)||void 0===t?void 0:t.length)!==void 0?(0,s.jsx)("span",{className:"post-count",children:(0,s.jsx)(b.Z,{count:null==e?void 0:null===(l=e.posts)||void 0===l?void 0:l.length,overflowCount:999,style:{backgroundColor:"#328f68",color:"white",fontWeight:"bold",borderRadius:"10px"}})}):"N/A"]})]})}),(0,s.jsx)("div",{className:"user-info",children:(0,s.jsxs)("div",{className:"button-group",children:[!e.isUpdating&&"Admin"!==e.role&&(0,s.jsx)(m.default,{type:e.isActive?"danger":"success",onClick:()=>M(e),id:"disable",children:e.isActive?"Disable":"Enable"}),(0,s.jsx)(m.default,{onClick:()=>O(e._id),children:"Edit"},"editUser")]})})]})}}),i.length>5&&(0,s.jsx)(f.default,{current:R,pageSize:5,total:i.length,onChange:e=>E(e),style:{marginTop:16,textAlign:"center"}})]})};return(0,s.jsxs)(A.Z,{children:[(0,s.jsx)(r.default,{style:{padding:20,marginLeft:150,marginRight:50,marginTop:60,backgroundColor:"dark"===z?"#222":"transparent"},children:(0,s.jsxs)(d.default,{span:24,children:[(0,s.jsxs)("h2",{style:{marginBottom:20,fontSize:24,color:"dark"===z?"white":"black"},className:"jsx-7abcd94d8188c663",children:["All Users (",null==l?void 0:l.length,")"]}),(0,s.jsxs)("div",{style:{marginBottom:20},className:"jsx-7abcd94d8188c663",children:[(0,s.jsx)(N,{placeholder:"Search by name, email, or role",value:F.searchTerm,onChange:e=>T({...F,searchTerm:e.target.value}),style:{width:300,marginRight:10}}),(0,s.jsxs)(p.default,{placeholder:"Filter by role",value:F.role,onChange:e=>T({...F,role:e}),style:{width:150,marginRight:10},children:[(0,s.jsx)(C,{value:"",children:"All Roles"}),(0,s.jsx)(C,{value:"Admin",children:"Admin"}),(0,s.jsx)(C,{value:"Author",children:"Author"}),(0,s.jsx)(C,{value:"Subscriber",children:"Subscriber"}),(0,s.jsx)(C,{value:"Reviewer",children:"Reviewer"}),(0,s.jsx)(C,{value:"Reader",children:"Reader"})]}),(0,s.jsxs)(p.default,{placeholder:"Filter by status",value:null===F.isActive?"":F.isActive.toString(),onChange:e=>{T({...F,isActive:""===e?null:"true"===e})},style:{width:150,marginRight:10},children:[(0,s.jsx)(C,{value:"",children:"All Status"}),(0,s.jsx)(C,{value:"true",children:"Active"}),(0,s.jsx)(C,{value:"false",children:"Disabled"})]}),(0,s.jsxs)(p.default,{placeholder:"Sort by",value:U.field,onChange:e=>B({...U,field:e}),style:{width:150,marginRight:10},children:[(0,s.jsx)(C,{value:"name",children:"Name"}),(0,s.jsx)(C,{value:"email",children:"Email"})]}),(0,s.jsxs)(p.default,{placeholder:"Order",value:U.order,onChange:e=>B({...U,order:e}),style:{width:100,marginRight:10},children:[(0,s.jsx)(C,{value:"asc",children:"Ascending"}),(0,s.jsx)(C,{value:"desc",children:"Descending"})]})]}),S?(0,s.jsx)(h.default,{tip:"Loading..."}):(0,s.jsxs)("div",{style:{display:"flex",flexDirection:"column"},className:"jsx-7abcd94d8188c663",children:[P("Admin",l.filter(e=>"Admin"===e.role)),P("Author",l.filter(e=>"Author"===e.role)),P("Subscriber",l.filter(e=>"Subscriber"===e.role)),P("Reviewer",l.filter(e=>"Reviewer"===e.role)),P("Reader",l.filter(e=>"Reader"===e.role))]})]})}),(0,s.jsx)(n(),{id:"7abcd94d8188c663",children:".user-info.jsx-7abcd94d8188c663{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;text-align:center;margin-top:10px}.posts-info.jsx-7abcd94d8188c663{margin-top:8px}.button-group.jsx-7abcd94d8188c663{margin-top:8px;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center}.post-count.jsx-7abcd94d8188c663{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;font-weight:bold;margin-left:8px}"})]})}}},function(e){e.O(0,[5584,5400,4104,1024,1350,4749,8065,3740,2476,4960,8931,6849,9774,2888,179],function(){return e(e.s=38153)}),_N_E=e.O()}]);