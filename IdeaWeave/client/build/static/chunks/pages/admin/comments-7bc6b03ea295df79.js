(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5897],{97097:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/comments",function(){return n(59034)}])},49923:function(e,t,n){"use strict";var i=n(85893),s=n(67294),a=n(11163),l=n(4851);t.Z=e=>{let{path:t="/"}=e,[n,d]=(0,s.useState)(3),o=(0,a.useRouter)();return(0,s.useEffect)(()=>{let e=setInterval(()=>{d(n-1)},1e3);return 0===n&&(clearInterval(e),o.push(t)),()=>clearInterval(e)},[n]),(0,i.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:(0,i.jsx)(l.default,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",fontSize:"50px",color:"red"}})})}},52988:function(e,t,n){"use strict";var i=n(85893),s=n(67294),a=n(42074),l=n(51024),d=n(65400);let{TextArea:o}=l.default;t.Z=e=>{let{comment:t,setComment:n,handleSubmit:l,loading:r}=e,[c,u]=(0,s.useContext)(a.V);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("br",{}),(0,i.jsx)(o,{value:t,onChange:e=>n(e.target.value),placeholder:"Write a comment...(Max: 2000)",rows:"4",disabled:(null==c?void 0:c.user)===null&&(null==c?void 0:c.token)==="",maxLength:2e3}),(0,i.jsx)(d.default,{style:{marginTop:5},loading:r,type:"primary",disabled:""===t||(null==c?void 0:c.user)===null&&(null==c?void 0:c.token)==="",onClick:l,children:"Post"})]})}},22631:function(e,t,n){"use strict";n.d(t,{Z:function(){return S}});var i=n(85893),s=n(67294),a=n(16373),l=n(12386),d=n(41664),o=n.n(d),r=n(9470),c=n(26401),u=n(5099),m=n(35741),f=n(65772),h=n(46403),v=n(63521),x=n(27478),j=n(42074),p=n(42567);let{SubMenu:y}=l.default,{Sider:w}=a.default;var g=()=>{var e,t,n,a;let[d,g]=(0,s.useState)(""),[b,I]=(0,s.useState)(""),[C,k]=(0,s.useContext)(j.V),[S]=(0,s.useContext)(p.N),[N,_]=(0,s.useState)(!1),Z=()=>{_(window.innerWidth<1e3)};(0,s.useEffect)(()=>{g(window.location.pathname);let e=window.location.pathname.split("/");return e.length>=3?I("/".concat(e[1])):I(""),window.addEventListener("resize",Z),()=>{window.removeEventListener("resize",Z)}},[]),(0,s.useEffect)(()=>{Z()},[]);let L={sider:{width:N?50:100,transition:"width 0.3s cubic-bezier(0.645, 0.045, 0.355, 1)",overflow:"hidden",paddingTop:"64px",height:"100vh"},fixedSider:{position:"fixed",top:0,left:0,bottom:0,zIndex:1e3,background:"dark"===S?"#001529":"#fff",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.1)"},menu:{background:"dark"===S?"#001529":"#fff",height:"calc(100% - 64px)",overflowY:"auto",overflowX:"hidden",scrollbarWidth:"thin",WebkitOverflowScrolling:"touch"},item:{background:"transparent",transition:"background 0.3s"},activeItem:{background:"dark"===S?"#007F7F":"#00BFFF",color:"#fff"},activeSubMenu:{background:"dark"===S?"#007F7F":"#00BFFF",color:"#fff",transition:"width 0.3s cubic-bezier(0.645, 0.045, 0.355, 1) 0.1s"}};return(0,i.jsx)(w,{collapsible:!0,collapsed:N,onCollapse:()=>_(!N),style:{...L.sider,...L.fixedSider},children:(0,i.jsxs)(l.default,{defaultOpenKeys:["2","6","10"],mode:"inline",inlineCollapsed:N,selectedKeys:[d],style:L.menu,theme:S,children:[(0,i.jsx)(l.default.Item,{icon:(0,i.jsx)(m.Z,{}),className:"/admin"===d?"active":"",style:"/admin"===d?L.activeItem:L.item,children:(0,i.jsx)(o(),{href:"/admin",children:"Dashboard"})},"/admin"),(0,i.jsx)(l.default.Item,{icon:(0,i.jsx)(x.Z,{}),className:"/admin/library"===d?"active":"",style:"/admin/library"===d?L.activeItem:L.item,children:(0,i.jsx)(o(),{href:"/admin/library",children:"Library"})},"/admin/library"),(0,i.jsxs)(y,{icon:(0,i.jsx)(r.Z,{}),title:"Posts",className:"/admin"===b?"active":"",style:"/admin"===b?L.activeSubMenu:{},children:[(0,i.jsx)(l.default.Item,{className:"/admin/posts"===d?"active":"",style:"/admin/posts"===d?L.activeItem:L.item,children:(0,i.jsx)(o(),{href:"/admin/posts",children:"All Books"})},"/admin/posts"),(0,i.jsx)(l.default.Item,{className:"/admin/posts/drafts"===d?"active":"",style:"/admin/posts/drafts"===d?L.activeItem:L.item,children:(0,i.jsx)(o(),{href:"/admin/posts/drafts",children:"All Drafts"})},"/admin/drafts"),(0,i.jsx)(l.default.Item,{className:"/admin/posts/new"===d?"active":"",style:"/admin/posts/new"===d?L.activeItem:L.item,children:(0,i.jsx)(o(),{href:"/admin/posts/new",children:"Add New Book"})},"/admin/posts/new"),(0,i.jsx)(l.default.Item,{className:"/admin/categories"===d?"active":"",style:"/admin/categories"===d?L.activeItem:L.item,children:(0,i.jsx)(o(),{href:"/admin/categories",children:"Categories"})},"/admin/categories")]},"2"),(0,i.jsxs)(y,{icon:(0,i.jsx)(c.Z,{}),title:"Media",children:[(0,i.jsx)(l.default.Item,{className:"/admin/media/library"===d?"active":"",style:"/admin/media/library"===d?L.activeItem:L.item,children:(0,i.jsx)(o(),{href:"/admin/media/library",children:"Media Library"})},"/admin/media/library"),(0,i.jsx)(l.default.Item,{className:"/admin/media/new"===d?"active":"",style:"/admin/media/new"===d?L.activeItem:L.item,children:(0,i.jsx)(o(),{href:"/admin/media/new",children:"Add New Media"})},"/admin/media/new")]},"6"),(0,i.jsx)(l.default.Item,{icon:(0,i.jsx)(v.Z,{}),className:"/admin/comments"===d?"active":"",style:"/admin/comments"===d?L.activeItem:L.item,children:(0,i.jsx)(o(),{href:"/admin/comments",children:"Comments"})},"/admin/comments"),(0,i.jsxs)(y,{icon:(0,i.jsx)(u.Z,{}),title:"Users",children:[(0,i.jsx)(l.default.Item,{className:"/admin/users"===d?"active":"",style:"/admin/users"===d?L.activeItem:L.item,children:(0,i.jsx)(o(),{href:"/admin/users",children:"All Users"})},"/admin/users"),(0,i.jsx)(l.default.Item,{className:"/admin/users/new"===d?"active":"",style:"/admin/users/new"===d?L.activeItem:L.item,children:(0,i.jsx)(o(),{href:"/admin/users/new",children:"Add New"})},"/admin/users/new")]},"10"),(0,i.jsx)(l.default.Item,{icon:(0,i.jsx)(h.Z,{}),className:d==="/admin/".concat(null==C?void 0:null===(e=C.user)||void 0===e?void 0:e._id)?"active":"",style:d==="/admin/".concat(null==C?void 0:null===(t=C.user)||void 0===t?void 0:t._id)?L.activeItem:L.item,children:(0,i.jsx)(o(),{href:"/admin/".concat(null==C?void 0:null===(n=C.user)||void 0===n?void 0:n._id),id:"profile",children:"Profile"})},"/admin/".concat(null==C?void 0:null===(a=C.user)||void 0===a?void 0:a._id)),(0,i.jsx)(l.default.Item,{icon:(0,i.jsx)(f.Z,{}),className:"/admin/customize"===d?"active":"",style:"/admin/customize"===d?L.activeItem:L.item,children:(0,i.jsx)(o(),{href:"/admin/customize",children:"Customize"})},"/admin/customize")]})})},b=n(11163),I=n(6154),C=n(49923);let{Content:k}=a.default;function S(e){let{children:t}=e,[n,l]=(0,s.useContext)(j.V),[d,o]=(0,s.useState)(!0),[r,c]=(0,s.useState)(!0),u=(0,b.useRouter)();(0,s.useEffect)(()=>{(null==n?void 0:n.token)&&m()},[null==n?void 0:n.token]);let m=async()=>{try{let{data:e}=await I.Z.get("/current-admin");o(!1)}catch(e){console.log(e),u.push("/")}};return d?(0,i.jsx)(C.Z,{}):(0,i.jsxs)(a.default,{children:[(0,i.jsx)(g,{isOpen:r,toggleNav:()=>{c(!r)}}),(0,i.jsx)(a.default,{style:{marginLeft:r?90:80,transition:"margin 0.5s"},children:(0,i.jsx)(k,{style:{padding:"10px"},children:t})})]})}},59034:function(e,t,n){"use strict";n.r(t);var i=n(85893),s=n(67294),a=n(55673),l=n(5789),d=n(51024),o=n(56697),r=n(89552),c=n(70302),u=n(22631),m=n(41664),f=n.n(m),h=n(3855),v=n(6154),x=n(11163),j=n(42074),p=n(27484),y=n.n(p),w=n(56176),g=n.n(w),b=n(52988),I=n(86501);y().extend(g());let{confirm:C}=o.default;t.default=function(){let[e,t]=(0,s.useContext)(j.V),[n,m]=(0,s.useState)(1),[p,w]=(0,s.useState)(0),[g,k]=(0,s.useState)([]),[S,N]=(0,s.useState)(!0),[_,Z]=(0,s.useState)({}),[L,E]=(0,s.useState)(""),[z,F]=(0,s.useState)(!1),[A,B]=(0,s.useState)(""),[T,O]=(0,s.useState)(null);(0,x.useRouter)();let[M,P]=(0,s.useState)(!1);(0,s.useEffect)(()=>{(null==e?void 0:e.token)&&(V(),W())},[null==e?void 0:e.token]);let V=async()=>{try{let{data:e}=await v.Z.get("/all-comments");k([...g,...e]),N(!1)}catch(e){console.error(e),N(!1)}},R=e=>{Z(e),E(e.content),P(!0)},W=async()=>{try{let{data:e}=await v.Z.get("/comment-count");w(e)}catch(e){console.error(e)}},U=async e=>{C({title:"Are you sure you want to hide this comment?",icon:(0,i.jsx)(h.default,{}),content:"This action cannot be undone.",async onOk(){try{let{data:t}=await v.Z.put("/hide-comment/".concat(e._id));(null==t?void 0:t.success)&&(k(g.filter(t=>t._id!==e._id)),w(p-1),I.Am.success("Comment hidden successfully"))}catch(e){console.error(e)}},onCancel(){}})},X=async()=>{try{N(!0);let{data:e}=await v.Z.put("/comment/".concat(_._id),{content:L});k(t=>t.map(t=>t._id===_._id?{...t,content:e.content}:t)),F(!1),N(!1),Z({}),E(""),I.Am.success("Comment updated")}catch(e){console.error(e),F(!1)}},D=null==g?void 0:g.filter(e=>{let t=A.toLowerCase().split(" ");return t.every(t=>{var n,i,s;return[null==e?void 0:e.content,null==e?void 0:null===(n=e.postedBy)||void 0===n?void 0:n.name,null==e?void 0:null===(i=e.postedBy)||void 0===i?void 0:i.role,null==e?void 0:null===(s=e.postId)||void 0===s?void 0:s.title].some(e=>e&&e.toLowerCase().includes(t))})}),[K,H]=(0,s.useState)(""),Y=e=>{let t=g.filter(t=>{var n;return(null==t?void 0:null===(n=t.postId)||void 0===n?void 0:n.title)===e});O({title:e,comments:t}),F(!0)},q=[...new Set(D.map(e=>{var t;return null==e?void 0:null===(t=e.postId)||void 0===t?void 0:t.title}))];return(0,i.jsxs)(u.Z,{children:[S?(0,i.jsx)(r.default,{size:"large",style:{marginLeft:120,marginTop:80}}):(0,i.jsx)(a.default,{style:{paddingLeft:80,marginTop:40,paddingRight:50},children:(0,i.jsxs)(l.default,{xs:24,sm:24,lg:16,offset:1,children:[(0,i.jsxs)("h1",{style:{marginTop:15},children:[p," Comments"]}),q.map(e=>(0,i.jsx)(c.default,{title:e,onClick:()=>Y(e),style:{marginBottom:16,cursor:"pointer"}},e))]})}),(0,i.jsx)(a.default,{children:(0,i.jsx)(l.default,{span:24,children:(0,i.jsxs)(o.default,{visible:z,title:"Comments for ".concat(null==T?void 0:T.title),onOk:()=>F(!1),onCancel:()=>F(!1),footer:null,children:[(0,i.jsx)(d.default,{placeholder:"Search comments",type:"search",value:K,onChange:e=>H(e.target.value.toLowerCase()),style:{marginBottom:16}}),null==T?void 0:T.comments.filter(e=>e.content.toLowerCase().includes(K)).map(t=>{var n,s;return(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{children:t.content}),(0,i.jsx)("p",{children:"".concat(null==t?void 0:null===(n=t.postedBy)||void 0===n?void 0:n.name," | ").concat(y()(t.createdAt).format("L LT"))}),(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,i.jsx)(f(),{href:"/post/".concat(null==t?void 0:null===(s=t.postId)||void 0===s?void 0:s.slug,"#").concat(t._id),children:"View"}),e.user&&t.postedBy.name===e.user.name&&(0,i.jsx)(i.Fragment,{children:(0,i.jsx)("a",{onClick:()=>{R(t),P(!0)},children:"Edit"})}),(0,i.jsx)("a",{onClick:()=>U(t),children:"Hide"})]}),(0,i.jsx)("hr",{})]},t._id)})]})})}),(0,i.jsx)(a.default,{children:(0,i.jsx)(l.default,{span:24,children:(0,i.jsx)(o.default,{visible:M,title:"Update comment",onOk:()=>P(!1),onCancel:()=>P(!1),footer:null,children:(0,i.jsx)(b.Z,{handleSubmit:X,comment:L,setComment:E,loading:S})})})})]})}}},function(e){e.O(0,[5584,5400,4104,1024,1350,6298,6697,533,6995,9774,2888,179],function(){return e(e.s=97097)}),_N_E=e.O()}]);