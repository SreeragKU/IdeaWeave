"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[822],{62466:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M766.4 744.3c43.7 0 79.4-36.2 79.4-80.5 0-53.5-79.4-140.8-79.4-140.8S687 610.3 687 663.8c0 44.3 35.7 80.5 79.4 80.5zm-377.1-44.1c7.1 7.1 18.6 7.1 25.6 0l256.1-256c7.1-7.1 7.1-18.6 0-25.6l-256-256c-.6-.6-1.3-1.2-2-1.7l-78.2-78.2a9.11 9.11 0 00-12.8 0l-48 48a9.11 9.11 0 000 12.8l67.2 67.2-207.8 207.9c-7.1 7.1-7.1 18.6 0 25.6l255.9 256zm12.9-448.6l178.9 178.9H223.4l178.8-178.9zM904 816H120c-4.4 0-8 3.6-8 8v80c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-80c0-4.4-3.6-8-8-8z"}}]},name:"bg-colors",theme:"outlined"}},11776:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M759 335c0-137-111-248-248-248S263 198 263 335c0 82.8 40.6 156.2 103 201.2-.4.2-.7.3-.9.4-44.7 18.9-84.8 46-119.3 80.6a373.42 373.42 0 00-80.4 119.5A373.6 373.6 0 00136 874.8a8 8 0 008 8.2h59.9c4.3 0 7.9-3.5 8-7.8 2-77.2 32.9-149.5 87.6-204.3C356 614.2 431 583 511 583c137 0 248-111 248-248zM511 507c-95 0-172-77-172-172s77-172 172-172 172 77 172 172-77 172-172 172zm105 221h264c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H703.5l47.2-60.1a8.1 8.1 0 001.7-4.9c0-4.4-3.6-8-8-8h-72.6c-4.9 0-9.5 2.3-12.6 6.1l-68.5 87.1c-4.4 5.6-6.8 12.6-6.8 19.8.1 17.7 14.4 32 32.1 32zm240 64H592c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h176.5l-47.2 60.1a8.1 8.1 0 00-1.7 4.9c0 4.4 3.6 8 8 8h72.6c4.9 0 9.5-2.3 12.6-6.1l68.5-87.1c4.4-5.6 6.8-12.6 6.8-19.8-.1-17.7-14.4-32-32.1-32z"}}]},name:"user-switch",theme:"outlined"}},65772:function(e,t,a){var l=a(64836),i=a(18698);t.Z=void 0;var n=l(a(42122)),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!=typeof e)return{default:e};var a=c(t);if(a&&a.has(e))return a.get(e);var l={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var r=n?Object.getOwnPropertyDescriptor(e,o):null;r&&(r.get||r.set)?Object.defineProperty(l,o,r):l[o]=e[o]}return l.default=e,a&&a.set(e,l),l}(a(67294)),r=l(a(62466)),s=l(a(92074));function c(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(c=function(e){return e?a:t})(e)}var d=function(e,t){return o.createElement(s.default,(0,n.default)((0,n.default)({},e),{},{ref:t,icon:r.default}))};d.displayName="BgColorsOutlined";var u=o.forwardRef(d);t.Z=u},5099:function(e,t,a){var l=a(64836),i=a(18698);t.Z=void 0;var n=l(a(42122)),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!=typeof e)return{default:e};var a=c(t);if(a&&a.has(e))return a.get(e);var l={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var r=n?Object.getOwnPropertyDescriptor(e,o):null;r&&(r.get||r.set)?Object.defineProperty(l,o,r):l[o]=e[o]}return l.default=e,a&&a.set(e,l),l}(a(67294)),r=l(a(11776)),s=l(a(92074));function c(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(c=function(e){return e?a:t})(e)}var d=function(e,t){return o.createElement(s.default,(0,n.default)((0,n.default)({},e),{},{ref:t,icon:r.default}))};d.displayName="UserSwitchOutlined";var u=o.forwardRef(d);t.Z=u},49923:function(e,t,a){var l=a(85893),i=a(67294),n=a(11163),o=a(4851);t.Z=e=>{let{path:t="/"}=e,[a,r]=(0,i.useState)(3),s=(0,n.useRouter)();return(0,i.useEffect)(()=>{let e=setInterval(()=>{r(a-1)},1e3);return 0===a&&(clearInterval(e),s.push(t)),()=>clearInterval(e)},[a]),(0,l.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:(0,l.jsx)(o.default,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",fontSize:"50px",color:"red"}})})}},22631:function(e,t,a){a.d(t,{Z:function(){return I}});var l=a(85893),i=a(67294),n=a(16373),o=a(12386),r=a(41664),s=a.n(r),c=a(9470),d=a(26401),u=a(5099),m=a(35741),f=a(65772),p=a(46403),h=a(63521),v=a(27478),x=a(42074),g=a(42567);let{SubMenu:y}=o.default,{Sider:j}=n.default;var b=()=>{var e,t,a,n;let[r,b]=(0,i.useState)(""),[w,S]=(0,i.useState)(""),[C,k]=(0,i.useContext)(x.V),[I]=(0,i.useContext)(g.N),[N,M]=(0,i.useState)(!1),Z=()=>{M(window.innerWidth<1e3)};(0,i.useEffect)(()=>{b(window.location.pathname);let e=window.location.pathname.split("/");return e.length>=3?S("/".concat(e[1])):S(""),window.addEventListener("resize",Z),()=>{window.removeEventListener("resize",Z)}},[]),(0,i.useEffect)(()=>{Z()},[]);let O={sider:{width:N?50:100,transition:"width 0.3s cubic-bezier(0.645, 0.045, 0.355, 1)",overflow:"hidden",paddingTop:"64px",height:"100vh"},fixedSider:{position:"fixed",top:0,left:0,bottom:0,zIndex:1e3,background:"dark"===I?"#001529":"#fff",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.1)"},menu:{background:"dark"===I?"#001529":"#fff",height:"calc(100% - 64px)",overflowY:"auto",overflowX:"hidden",scrollbarWidth:"thin",WebkitOverflowScrolling:"touch"},item:{background:"transparent",transition:"background 0.3s"},activeItem:{background:"dark"===I?"#007F7F":"#00BFFF",color:"#fff"},activeSubMenu:{background:"dark"===I?"#007F7F":"#00BFFF",color:"#fff",transition:"width 0.3s cubic-bezier(0.645, 0.045, 0.355, 1) 0.1s"}};return(0,l.jsx)(j,{collapsible:!0,collapsed:N,onCollapse:()=>M(!N),style:{...O.sider,...O.fixedSider},children:(0,l.jsxs)(o.default,{defaultOpenKeys:["2","6","10"],mode:"inline",inlineCollapsed:N,selectedKeys:[r],style:O.menu,theme:I,children:[(0,l.jsx)(o.default.Item,{icon:(0,l.jsx)(m.Z,{}),className:"/admin"===r?"active":"",style:"/admin"===r?O.activeItem:O.item,children:(0,l.jsx)(s(),{href:"/admin",children:"Dashboard"})},"/admin"),(0,l.jsx)(o.default.Item,{icon:(0,l.jsx)(v.Z,{}),className:"/admin/library"===r?"active":"",style:"/admin/library"===r?O.activeItem:O.item,children:(0,l.jsx)(s(),{href:"/admin/library",children:"Library"})},"/admin/library"),(0,l.jsxs)(y,{icon:(0,l.jsx)(c.Z,{}),title:"Posts",className:"/admin"===w?"active":"",style:"/admin"===w?O.activeSubMenu:{},children:[(0,l.jsx)(o.default.Item,{className:"/admin/posts"===r?"active":"",style:"/admin/posts"===r?O.activeItem:O.item,children:(0,l.jsx)(s(),{href:"/admin/posts",children:"All Books"})},"/admin/posts"),(0,l.jsx)(o.default.Item,{className:"/admin/posts/drafts"===r?"active":"",style:"/admin/posts/drafts"===r?O.activeItem:O.item,children:(0,l.jsx)(s(),{href:"/admin/posts/drafts",children:"All Drafts"})},"/admin/drafts"),(0,l.jsx)(o.default.Item,{className:"/admin/posts/new"===r?"active":"",style:"/admin/posts/new"===r?O.activeItem:O.item,children:(0,l.jsx)(s(),{href:"/admin/posts/new",children:"Add New Book"})},"/admin/posts/new"),(0,l.jsx)(o.default.Item,{className:"/admin/categories"===r?"active":"",style:"/admin/categories"===r?O.activeItem:O.item,children:(0,l.jsx)(s(),{href:"/admin/categories",children:"Categories"})},"/admin/categories")]},"2"),(0,l.jsxs)(y,{icon:(0,l.jsx)(d.Z,{}),title:"Media",children:[(0,l.jsx)(o.default.Item,{className:"/admin/media/library"===r?"active":"",style:"/admin/media/library"===r?O.activeItem:O.item,children:(0,l.jsx)(s(),{href:"/admin/media/library",children:"Media Library"})},"/admin/media/library"),(0,l.jsx)(o.default.Item,{className:"/admin/media/new"===r?"active":"",style:"/admin/media/new"===r?O.activeItem:O.item,children:(0,l.jsx)(s(),{href:"/admin/media/new",children:"Add New Media"})},"/admin/media/new")]},"6"),(0,l.jsx)(o.default.Item,{icon:(0,l.jsx)(h.Z,{}),className:"/admin/comments"===r?"active":"",style:"/admin/comments"===r?O.activeItem:O.item,children:(0,l.jsx)(s(),{href:"/admin/comments",children:"Comments"})},"/admin/comments"),(0,l.jsxs)(y,{icon:(0,l.jsx)(u.Z,{}),title:"Users",children:[(0,l.jsx)(o.default.Item,{className:"/admin/users"===r?"active":"",style:"/admin/users"===r?O.activeItem:O.item,children:(0,l.jsx)(s(),{href:"/admin/users",children:"All Users"})},"/admin/users"),(0,l.jsx)(o.default.Item,{className:"/admin/users/new"===r?"active":"",style:"/admin/users/new"===r?O.activeItem:O.item,children:(0,l.jsx)(s(),{href:"/admin/users/new",children:"Add New"})},"/admin/users/new")]},"10"),(0,l.jsx)(o.default.Item,{icon:(0,l.jsx)(p.Z,{}),className:r==="/admin/".concat(null==C?void 0:null===(e=C.user)||void 0===e?void 0:e._id)?"active":"",style:r==="/admin/".concat(null==C?void 0:null===(t=C.user)||void 0===t?void 0:t._id)?O.activeItem:O.item,children:(0,l.jsx)(s(),{href:"/admin/".concat(null==C?void 0:null===(a=C.user)||void 0===a?void 0:a._id),id:"profile",children:"Profile"})},"/admin/".concat(null==C?void 0:null===(n=C.user)||void 0===n?void 0:n._id)),(0,l.jsx)(o.default.Item,{icon:(0,l.jsx)(f.Z,{}),className:"/admin/customize"===r?"active":"",style:"/admin/customize"===r?O.activeItem:O.item,children:(0,l.jsx)(s(),{href:"/admin/customize",children:"Customize"})},"/admin/customize")]})})},w=a(11163),S=a(6154),C=a(49923);let{Content:k}=n.default;function I(e){let{children:t}=e,[a,o]=(0,i.useContext)(x.V),[r,s]=(0,i.useState)(!0),[c,d]=(0,i.useState)(!0),u=(0,w.useRouter)();(0,i.useEffect)(()=>{(null==a?void 0:a.token)&&m()},[null==a?void 0:a.token]);let m=async()=>{try{let{data:e}=await S.Z.get("/current-admin");s(!1)}catch(e){console.log(e),u.push("/")}};return r?(0,l.jsx)(C.Z,{}):(0,l.jsxs)(n.default,{children:[(0,l.jsx)(b,{isOpen:c,toggleNav:()=>{d(!c)}}),(0,l.jsx)(n.default,{style:{marginLeft:c?90:80,transition:"margin 0.5s"},children:(0,l.jsx)(k,{style:{padding:"10px"},children:t})})]})}},50721:function(e,t,a){var l=a(85893),i=a(67294),n=a(28465),o=a(11187),r=a(91633),s=a(84996),c=a(35297),d=a(42074),u=a(92018),m=a(83555),f=a(94212),p=a(6154),h=a(86501);let{Dragger:v}=n.default;t.Z=e=>{var t;let{page:a="admin"}=e,[n,x]=(0,i.useContext)(d.V),[g,y]=(0,i.useContext)(f.Y),[j,b]=(0,i.useState)(!1);(0,i.useEffect)(()=>{let e=async()=>{try{let{data:e}=await p.Z.get("/media");y(t=>({...t,images:e}))}catch(e){console.log(e)}};e()},[]);let w={name:"file",multiple:!0,action:"".concat("https://ideaweave-backend.onrender.com/api","/upload-image-file"),headers:{Authorization:"Bearer ".concat(n.token)},onChange(e){"uploading"!==e.file.status&&console.log(e.file,e.fileList),"done"===e.file.status?(o.default.success("".concat(e.file.name," file uploaded successfully")),y({images:[...g.images,e.file.response],selected:e.file.response,showMediaModal:!1})):"error"===e.file.status&&o.default.error("".concat(e.file.name," file upload failed."))},onDrop(e){console.log("Dropped files",e.dataTransfer.files)}},S=async e=>{try{let{data:t}=await p.Z.delete("/media/".concat(e));t.ok&&(y({...g,images:g.images.filter(t=>t._id!==e),selected:null}),h.Am.success("Image deleted successfully"))}catch(e){console.log(e)}};return(0,l.jsxs)("div",{style:{width:"75%",margin:"0 auto",marginTop:40},children:[(0,l.jsxs)(v,{...w,accept:"image/*",children:[(0,l.jsx)("p",{className:"ant-upload-drag-icon",children:(0,l.jsx)(m.Z,{})}),(0,l.jsx)("p",{className:"ant-upload-text",children:"Click or drag file to this area to upload"})]}),(0,l.jsx)("div",{style:{textAlign:"center",marginTop:20,display:"flex",flexWrap:"wrap",justifyContent:"center"},children:null==g?void 0:null===(t=g.images)||void 0===t?void 0:t.filter(e=>{var t,l;return"admin"===a||(null==e?void 0:null===(t=e.postedBy)||void 0===t?void 0:t._id)===(null==n?void 0:null===(l=n.user)||void 0===l?void 0:l._id)}).map(e=>{var t,i;return(0,l.jsx)(s.Z,{children:(0,l.jsxs)("div",{style:{margin:"10px",padding:"10px",border:"1px solid #ddd",borderRadius:"8px",boxShadow:"0 4px 8px rgba(0, 0, 0, 0.1)",position:"relative"},children:[(0,l.jsx)(r.Z,{onClick:()=>y({...g,selected:e}),preview:j,src:e.url,style:{height:"100px",width:"100px",objectFit:"cover",cursor:"pointer",borderRadius:"8px"}}),(0,l.jsx)("br",{}),"author"===a&&(null==e?void 0:null===(t=e.postedBy)||void 0===t?void 0:t._id)==(null==n?void 0:null===(i=n.user)||void 0===i?void 0:i._id)?(0,l.jsx)(c.Z,{title:"Are you sure to delete this image?",onConfirm:()=>S(e._id),okText:"Yes",cancelText:"No",placement:"bottomRight",children:(0,l.jsx)(u.default,{style:{position:"absolute",bottom:"5px",right:"5px",color:"#f5222d",cursor:"pointer"}})}):"admin"===a?(0,l.jsx)(c.Z,{title:"Are you sure to delete this image?",onConfirm:()=>S(e._id),okText:"Yes",cancelText:"No",placement:"bottomRight",children:(0,l.jsx)(u.default,{style:{position:"absolute",bottom:"5px",right:"5px",color:"#f5222d",cursor:"pointer"}})}):""]})},e._id)})})]})}},93338:function(e,t,a){var l=a(85893),i=a(67294),n=a(28465),o=a(11187),r=a(65400),s=a(42074),c=a(35855),d=a(94212),u=a(11163);t.Z=e=>{let{redirectToLibrary:t=!1,page:a="admin"}=e,[m,f]=(0,i.useContext)(s.V),[p,h]=(0,i.useContext)(d.Y),v=(0,u.useRouter)(),x={name:"file",action:"".concat("https://ideaweave-backend.onrender.com/api","/upload-image-file"),headers:{Authorization:"Bearer ".concat(m.token)},onChange(e){"uploading"!==e.file.status&&console.log(e.file,e.fileList),"done"===e.file.status?(o.default.success("".concat(e.file.name," file uploaded successfully")),h({images:[...p.images,e.file.response],selected:e.file.response,showMediaModal:!1}),t&&v.push("/".concat(a,"/media/library"))):"error"===e.file.status&&o.default.error("".concat(e.file.name," file upload failed."))}};return(0,l.jsxs)("div",{children:[(0,l.jsx)("style",{children:"\n          .ant-upload-list-item-card-actions {\n            display: none;\n          }\n        "}),(0,l.jsx)(n.default,{...x,maxCount:1,children:(0,l.jsx)(r.default,{icon:(0,l.jsx)(c.Z,{}),children:"Click to Upload"})})]})}},90148:function(e,t,a){var l=a(85893);a(67294);var i=a(93338),n=a(50721),o=a(20838);let{TabPane:r}=o.default;t.Z=()=>(0,l.jsxs)(o.default,{children:[(0,l.jsx)(r,{tab:"Upload File",children:(0,l.jsx)(i.Z,{})},"1"),(0,l.jsx)(r,{tab:"Media Library",children:(0,l.jsx)(n.Z,{})},"2")]})},68214:function(e,t,a){var l=a(85893);a(67294);var i=a(56697);t.Z=function(e){let{visible:t,imageUrl:a,onClose:n}=e;return(0,l.jsx)(i.default,{visible:t,title:"Image Preview",footer:null,onCancel:n,bodyStyle:{padding:0},width:"67%",style:{top:0,height:"100%"},children:(0,l.jsx)("img",{alt:"Image Preview",style:{width:"100%",display:"flex",overflow:"hidden"},src:a})})}},4854:function(e,t,a){var l=a(85893),i=a(67294);a(28934);var n=a(6154),o=a(16373),r=a(64749),s=a(55673),c=a(5789),d=a(51024),u=a(65400),m=a(56697),f=a(70302),p=a(68469),h=a(20838),v=a(94704),x=a(5152),g=a.n(x),y=a(86501),j=a(11163),b=a(35855),w=a(42419),S=a(32615),C=a(58452),k=a(90148),I=a(94212),N=a(68214);let M=g()(()=>Promise.all([a.e(2937),a.e(1167),a.e(3218)]).then(a.t.bind(a,71167,23)),{loadableGenerated:{webpack:()=>[71167]},ssr:!1,loading:()=>(0,l.jsx)("p",{children:"Loading ..."})}),{Content:Z}=o.default,{Option:O}=r.default,{Panel:z}=p.default,{TabPane:_}=h.default,P={toolbar:[[{font:[]}],[{size:["small",!1,"large","huge"]}],["bold","italic","underline","strike"],["blockquote","code-block"],[{color:[]},{background:[]}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],["clean"]]},A=["font","size","bold","italic","underline","strike","blockquote","list","bullet","indent","script","color","background"],B={height:"500px",overflowY:"auto",padding:"20px"};t.Z=function(e){var t,a,o;let{page:x="admin"}=e,[g,Z]=(0,i.useState)({}),[E,T]=(0,i.useState)(""),[L,R]=(0,i.useState)([]),[D,F]=(0,i.useState)(""),[q,V]=(0,i.useState)({}),[W,H]=(0,i.useState)(!1),[J,U]=(0,i.useState)(!0),Y=(0,j.useRouter)(),[K,G]=(0,i.useContext)(I.Y),[X,Q]=(0,i.useState)(0),{Step:$}=v.default,[ee,et]=(0,i.useState)([]),[ea,el]=(0,i.useState)(!1),[ei,en]=(0,i.useState)(""),[eo,er]=(0,i.useState)([]),[es,ec]=(0,i.useState)([]);(0,i.useEffect)(()=>{ed(),eu()},[]),(0,i.useEffect)(()=>{eu()},[null==Y?void 0:null===(t=Y.query)||void 0===t?void 0:t.slug]);let ed=async()=>{try{let{data:e}=await n.Z.get("/category");R(e)}catch(e){console.log(e)}},eu=async()=>{try{let{data:e}=await n.Z.get("/draft/".concat(Y.query.slug));T(e.post.title),Z(e.post.content),V(e.post.coverImage),F(e.post._id);let t=e.post.volumes.map(e=>({volume:e.volume,chapters:e.chapters.map(e=>({name:e.name||"Chapter ".concat(chapterIndex+1),content:e.content}))}));et(t);let a=[];e.post.categories.map(e=>a.push(e.name)),er(a),U(!1)}catch(e){console.log(e),U(!1)}},em=async()=>{try{var e,t;U(!0);let a=ee.filter(e=>e.volume&&e.chapters.length>=1).map((e,t)=>"".concat(e.volume,": ").concat(e.chapters.map((e,a)=>{var l;return"Chapter ".concat(e.chapter||"1",": ").concat(e.name," - ").concat((null===(l=g["".concat(t,"-").concat(a)])||void 0===l?void 0:l.content)||ef(t,a)||"")}).join(", "))).join("; "),l=eo.length>0?eo:es,i={title:E,content:'<div style="font-size: 1.2rem; line-height: 1.6">'.concat(a,"</div>"),categories:l,coverImage:(null==K?void 0:null===(e=K.selected)||void 0===e?void 0:e._id)?null==K?void 0:null===(t=K.selected)||void 0===t?void 0:t._id:(null==q?void 0:q._id)?q._id:void 0,volumes:ee.map((e,t)=>({volume:e.volume,chapters:e.chapters.map((e,a)=>{let l="".concat(t,"-").concat(a),i=g[l];return{chapter:e.chapter||"1",name:e.name||"Untitled",content:(null==i?void 0:i.content)!==void 0?i.content:e.content}})}))},{data:o}=await n.Z.put("/edit-draft/".concat(D),i);(null==o?void 0:o.error)?(y.Am.error(null==o?void 0:o.error),U(!1)):(localStorage.removeItem("draft-edit-title"),localStorage.removeItem("draft-edit-volumes"),Object.keys(g).forEach(e=>{let t="draft-edit-volumes-".concat(e);localStorage.removeItem(t)}),localStorage.removeItem("draft-edit-image"),G({...K,selected:null}),Y.push("/".concat(x,"/drafts")),y.Am.success("Draft updated successfully"))}catch(e){console.error(e),y.Am.error("Draft update failed. Try again."),U(!1)}},ef=(e,t)=>{let a="".concat(e,"-").concat(t),l=JSON.parse(localStorage.getItem("draft-edit-volumes-".concat(a)));return(null==l?void 0:l.content)||""},ep=()=>{if(0===X)localStorage.setItem("draft-edit-title",JSON.stringify(E));else if(1===X){let e=JSON.parse(localStorage.getItem("draft-edit-volumes"))||[],t=JSON.parse(localStorage.getItem("draft-edit-image"))||{},a=ee.some((t,a)=>{let l=e[a]||{};return t.volume!==l.volume||t.chapters.some((e,t)=>{var a;let i=(null===(a=l.chapters)||void 0===a?void 0:a[t])||{};return e.name!==i.name||e.content!==i.content})});if(a){let e=ee.map(e=>({volume:e.volume,chapters:e.chapters.map(e=>({chapter:e.chapter||"1",name:e.name||"Untitled",content:e.content||""}))}));localStorage.setItem("draft-edit-volumes",JSON.stringify(e)),localStorage.setItem("draft-edit-image",JSON.stringify(null==K?void 0:K.selected))}else localStorage.setItem("draft-edit-volumes",JSON.stringify(e)),localStorage.setItem("draft-edit-image",JSON.stringify(t))}Q(X+1)},eh=()=>{Q(X-1)},ev=(e,t)=>{let a=[...ee];a[e].chapters.splice(t,1),a[e].chapters.forEach((e,t)=>{e.chapter=t+1,e.name="Chapter ".concat(e.chapter)});let l="".concat(e,"-").concat(t),i="draft-edit-volumes-".concat(l);localStorage.removeItem(i),et(a),Z(e=>{let{[l]:t,...a}=e;return a})},ex=e=>{let t=[...ee],a=t.splice(e,1)[0],l="volume-".concat(e);localStorage.removeItem(l),a.chapters.forEach((t,a)=>{let l="".concat(e,"-").concat(a),i="draft-edit-volumes-".concat(l);localStorage.removeItem(i)}),et(t),Z(t=>{let a=Object.keys(t).filter(t=>t.startsWith("".concat(e,"-"))),{[l]:i,...n}=t;return a.reduce((e,a)=>{let l="draft-edit-volumes-".concat(a);return localStorage.removeItem(l),{...e,[a]:t[a]}},n)})};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(s.default,{justify:"center",style:{paddingLeft:50,paddingTop:"50px",paddingRight:50},children:(0,l.jsx)(c.default,{span:18,children:(0,l.jsxs)(f.default,{style:{padding:"20px",marginBottom:"20px"},children:[(0,l.jsxs)(v.default,{current:X,style:{marginBottom:"20px"},children:[(0,l.jsx)($,{title:"Book Info"}),(0,l.jsx)($,{title:"Volumes and Chapters"}),(0,l.jsx)($,{title:"Review and Publish"})]}),0===X&&(0,l.jsxs)(f.default,{children:[(0,l.jsx)("h1",{children:"Create a new Book"}),(0,l.jsx)(d.default,{value:E,size:"large",placeholder:"Give your post a title",onChange:e=>{T(e.target.value)}}),(0,l.jsx)("br",{}),(0,l.jsx)("br",{}),(0,l.jsxs)(u.default,{style:{margin:"10px 0px 10px 0px",width:"100%"},onClick:()=>G({...K,showMediaModal:!0}),children:[(0,l.jsx)(b.Z,{})," Cover Image"]}),(null==K?void 0:K.selected)?(0,l.jsxs)("div",{style:{marginTop:"15px",position:"relative",cursor:"pointer",overflow:"hidden",transition:"transform 0.3s"},className:"image-container",onMouseEnter:()=>{let e=document.querySelector(".overlay");e.style.opacity=1},onMouseLeave:()=>{let e=document.querySelector(".overlay");e.style.opacity=0},onClick:()=>{if(null==K?void 0:K.selected){var e;en(null==K?void 0:null===(e=K.selected)||void 0===e?void 0:e.url),el(!0)}},children:[(0,l.jsx)("img",{style:{width:"100%",transition:"transform 0.3s"},src:null==K?void 0:null===(a=K.selected)||void 0===a?void 0:a.url,alt:"Image"}),(0,l.jsx)("div",{className:"overlay",style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",background:"rgba(0, 0, 0, 0.5)",color:"white",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",opacity:0,transition:"opacity 0.3s"},children:(0,l.jsxs)("div",{className:"overlay-content",style:{textAlign:"center"},children:[(0,l.jsx)(w.default,{style:{fontSize:"25px",color:"white"}}),(0,l.jsx)("br",{}),"Click to Preview"]})})]}):(null==q?void 0:q.url)?(0,l.jsxs)("div",{style:{marginTop:"15px",position:"relative",cursor:"pointer",overflow:"hidden",transition:"transform 0.3s"},className:"image-container",onMouseEnter:()=>{let e=document.querySelector(".overlay");e.style.opacity=1},onMouseLeave:()=>{let e=document.querySelector(".overlay");e.style.opacity=0},onClick:()=>{if(null==K?void 0:K.selected){var e;en(null==K?void 0:null===(e=K.selected)||void 0===e?void 0:e.url),el(!0)}},children:[(0,l.jsx)("img",{style:{width:"100%",transition:"transform 0.3s"},src:null==q?void 0:q.url,alt:"Image"}),(0,l.jsx)("div",{className:"overlay",style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",background:"rgba(0, 0, 0, 0.5)",color:"white",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",opacity:0,transition:"opacity 0.3s"},children:(0,l.jsxs)("div",{className:"overlay-content",style:{textAlign:"center"},children:[(0,l.jsx)(w.default,{style:{fontSize:"25px",color:"white"}}),(0,l.jsx)("br",{}),"Click to Preview"]})})]}):"",(0,l.jsx)("br",{}),(0,l.jsx)(u.default,{style:{margin:"10px 0px 10px 0px",width:"100%"},type:"primary",onClick:ep,children:"Next"})]}),1===X&&(0,l.jsxs)(f.default,{style:{marginBottom:"20px"},children:[(0,l.jsx)("h1",{children:"Volumes and Chapters"}),(0,l.jsx)(p.default,{accordion:!0,children:ee.map((e,t)=>(0,l.jsxs)(z,{header:"Volume ".concat(t+1),children:[(0,l.jsx)(d.default,{value:e.volume,size:"large",placeholder:"Volume ".concat(t+1),onChange:e=>{let a=[...ee];a[t].volume=e.target.value,et(a)}}),(0,l.jsx)("div",{style:{marginBottom:"10px"}}),(0,l.jsx)(h.default,{tabPosition:"left",children:e.chapters.map((e,a)=>(0,l.jsxs)(_,{tab:"Chapter ".concat(a+1),children:[(0,l.jsxs)("div",{style:{marginBottom:"10px"},children:[(0,l.jsxs)(u.default,{style:{marginRight:"8px"},type:"danger",onClick:()=>ev(t,a),children:["Remove Chapter ",a+1]}),(0,l.jsx)("span",{children:"Chapter ".concat(a+1,": ").concat(e.name)})]}),(0,l.jsx)(d.default,{value:e.name,placeholder:"Chapter ".concat(a+1," Name"),onChange:e=>{let l=[...ee];l[t].chapters[a].name=e.target.value,et(l)}}),(0,l.jsx)("div",{style:B,children:(0,l.jsx)(M,{modules:P,formats:A,placeholder:"Compose here...",value:e.content,onChange:(l,i,n,o)=>{let r=[...ee];r[t].chapters[a].content=l,et(r);let s="".concat(t,"-").concat(a);Z({...g,[s]:{content:l,name:"Chapter ".concat(a+1,": ").concat(e.name)}});let c="draft-edit-volumes-".concat(s);localStorage.setItem(c,JSON.stringify({content:l,name:"Chapter ".concat(a+1,": ").concat(e.name)}))},theme:"snow",style:{height:"400px",marginTop:"10px"}})})]},"chapter-".concat(t,"-").concat(a)))}),(0,l.jsx)(u.default,{style:{margin:"10px 0px 20px",width:"100%"},type:"dashed",icon:(0,l.jsx)(S.default,{}),onClick:()=>{let e=[...ee],a=e[t].chapters.length-1,l=a>=0?Math.max(...e[t].chapters.map(e=>e.chapter))+1:1;e[t].chapters.push({name:"Chapter ".concat(l),chapter:l,content:""}),et(e)},children:"Add Chapter"}),(0,l.jsxs)(u.default,{style:{margin:"10px 0px 20px",width:"100%"},onClick:()=>ex(t),children:["Remove Volume ",t+1]})]},"volume-".concat(t)))}),(0,l.jsx)(u.default,{style:{margin:"10px 0px 20px",width:"100%"},type:"dashed",icon:(0,l.jsx)(S.default,{}),onClick:()=>{et([...ee,{volume:"",chapters:[{chapter:"",content:""}]}])},children:"Add Volume"}),(0,l.jsxs)(s.default,{justify:"space-between",style:{marginTop:"20px"},children:[(0,l.jsx)(c.default,{children:(0,l.jsx)(u.default,{type:"primary",onClick:eh,children:"Previous"})}),(0,l.jsx)(c.default,{children:(0,l.jsx)(u.default,{type:"primary",onClick:ep,children:"Next"})})]})]}),2===X&&(0,l.jsxs)(f.default,{style:{maxWidth:"800px",margin:"auto",marginTop:"20px"},children:[(0,l.jsx)("h1",{style:{textAlign:"center",marginBottom:"20px"},children:"Review and Publish"}),(null==K?void 0:K.selected)?(0,l.jsxs)("div",{style:{marginTop:"15px",position:"relative",cursor:"pointer",overflow:"hidden",transition:"transform 0.3s"},className:"image-container",onMouseEnter:()=>{let e=document.querySelector(".overlay");e.style.opacity=1},onMouseLeave:()=>{let e=document.querySelector(".overlay");e.style.opacity=0},onClick:()=>{if(null==K?void 0:K.selected){var e;en(null==K?void 0:null===(e=K.selected)||void 0===e?void 0:e.url),el(!0)}},children:[(0,l.jsx)("img",{style:{width:"100%",transition:"transform 0.3s"},src:null==K?void 0:null===(o=K.selected)||void 0===o?void 0:o.url,alt:"Image"}),(0,l.jsx)("div",{className:"overlay",style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",background:"rgba(0, 0, 0, 0.5)",color:"white",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",opacity:0,transition:"opacity 0.3s"},children:(0,l.jsxs)("div",{className:"overlay-content",style:{textAlign:"center"},children:[(0,l.jsx)(w.default,{style:{fontSize:"25px",color:"white"}}),(0,l.jsx)("br",{}),"Click to Preview"]})})]}):(null==q?void 0:q.url)?(0,l.jsxs)("div",{style:{marginTop:"15px",position:"relative",cursor:"pointer",overflow:"hidden",transition:"transform 0.3s"},className:"image-container",onMouseEnter:()=>{let e=document.querySelector(".overlay");e.style.opacity=1},onMouseLeave:()=>{let e=document.querySelector(".overlay");e.style.opacity=0},onClick:()=>{if(null==K?void 0:K.selected){var e;en(null==K?void 0:null===(e=K.selected)||void 0===e?void 0:e.url),el(!0)}},children:[(0,l.jsx)("img",{style:{width:"100%",transition:"transform 0.3s"},src:null==q?void 0:q.url,alt:"Image"}),(0,l.jsx)("div",{className:"overlay",style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",background:"rgba(0, 0, 0, 0.5)",color:"white",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",opacity:0,transition:"opacity 0.3s"},children:(0,l.jsxs)("div",{className:"overlay-content",style:{textAlign:"center"},children:[(0,l.jsx)(w.default,{style:{fontSize:"25px",color:"white"}}),(0,l.jsx)("br",{}),"Click to Preview"]})})]}):"",(0,l.jsx)("h2",{children:"Book Title:"}),(0,l.jsx)("p",{children:E}),(0,l.jsx)("h2",{children:"Volumes and Chapters:"}),(0,l.jsx)(h.default,{defaultActiveKey:"0",type:"card",style:{marginBottom:"20px"},children:ee.map((e,t)=>(0,l.jsx)(_,{tab:"Volume ".concat(t+1,": ").concat(e.volume),children:(0,l.jsx)(h.default,{type:"card",children:e.chapters.map((e,a)=>{var i;let n="".concat(t,"-").concat(a),o=(null===(i=g[n])||void 0===i?void 0:i.content)||"",r=e.content||"";return(0,l.jsx)(_,{tab:"Chapter ".concat(a+1,": ").concat(e.name),children:(0,l.jsx)("div",{dangerouslySetInnerHTML:{__html:r!==o?r:o},style:{fontSize:"1.2rem",lineHeight:"1.6",padding:"20px"}})},n)})})},t.toString()))}),(0,l.jsx)("h2",{children:"Categories:"}),(0,l.jsx)("h4",{children:"Select categories for your post:"}),(0,l.jsx)(r.default,{mode:"multiple",allowClear:!0,placeholder:"Select categories",style:{width:"100%"},value:eo,onChange:e=>er(e),children:L.map(e=>(0,l.jsx)(O,{children:e.name},e.name))}),(0,l.jsx)("div",{style:{marginBottom:"10px"}}),(0,l.jsx)(u.default,{style:{width:"100%",marginBottom:"10px"},type:"primary",loading:J,icon:(0,l.jsx)(C.default,{}),onClick:()=>{if(0===eo.length){y.Am.error("Please choose at least one category before publishing.");return}em()},children:"Save to Draft"}),(0,l.jsx)(u.default,{style:{margin:"10px 0px 10px 0px",width:"100%"},type:"primary",onClick:eh,children:"Previous"})]})]})})}),(0,l.jsx)(N.Z,{visible:ea,imageUrl:ei,onClose:()=>el(!1)}),(0,l.jsxs)(m.default,{title:"Preview",centered:!0,visible:W,onOk:()=>H(!1),onCancel:()=>H(!1),width:720,footer:null,children:[(0,l.jsx)("h1",{style:{fontSize:"1.2rem",lineHeight:"1.6"},children:E}),(0,l.jsx)("div",{dangerouslySetInnerHTML:{__html:g},style:{fontSize:"1.2rem",lineHeight:"1.6"}})]}),(0,l.jsx)(m.default,{visible:K.showMediaModal,title:"Media",onOk:()=>H(!1),onCancel:()=>H(!1),width:720,footer:null,children:(0,l.jsx)(k.Z,{style:{fontSize:"1.2rem",lineHeight:"1.6"}})})]})}}}]);