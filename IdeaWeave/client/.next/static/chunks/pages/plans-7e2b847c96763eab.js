(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1892],{12797:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/plans",function(){return a(97603)}])},97603:function(e,t,a){"use strict";a.r(t);var i=a(85893),r=a(67294),n=a(6154),o=a(70302),s=a(5789),l=a(55673),c=a(65400),d=a(53740),u=a(42567),p=a(42074),x=a(11163),h=a(73818),f=a(10149),g=a(8448),m=a(59361),y=a(91819);a(18159);let{Title:b,Paragraph:j,Text:w}=d.default;t.default=()=>{let[e,t]=(0,r.useState)([]),{theme:a}=(0,r.useContext)(u.N),[d,D]=(0,r.useContext)(p.V),[S,v]=(0,r.useState)(null),[C,k]=(0,r.useState)(!1),P=(0,x.useRouter)();(0,r.useEffect)(()=>{_(),T()},[d]);let _=async()=>{try{if(d.user){let e=await n.Z.get("/subscription/".concat(d.user._id));v(e.data),e.data&&e.data.isActive&&P.push("/success.js")}}catch(e){console.error("Error checking user subscription:",e)}},T=async()=>{try{let{data:e}=await n.Z.get("/prices");t(e.data||[])}catch(e){console.error("Error fetching plans:",e)}},N=async e=>{try{if(!d.user){console.error("User not authenticated");return}let{_id:t}=d.user;k(!0);let a=await n.Z.post("/session",{priceId:e,userId:t,email:d.user.email});window.location.href=a.data.url}catch(e){console.error("Error initiating checkout:",e)}finally{k(!1)}},F=()=>({backgroundColor:"hsl(".concat(Math.floor(360*Math.random()),",").concat(Math.floor(30*Math.random())+50,"%,").concat("dark"===a?Math.floor(20*Math.random())+20:Math.floor(30*Math.random())+70,"%)"),color:"#000"}),[I,R]=(0,r.useState)(null),[A,E]=(0,r.useState)(!0);(0,r.useEffect)(()=>{d.user&&d.user._id&&z(d.user._id)},[d.user]);let z=async e=>{try{let t=await n.Z.get("/subscription/".concat(e),{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(d.token)}});if(200===t.status){let e=t.data;R(e)}else console.error("Failed to fetch subscription details:",t.status)}catch(e){console.error("Error fetching subscription details:",e)}finally{E(!1)}},M=e=>{e.setFont("helvetica"),e.setFontSize(12),e.setTextColor(100,100,100),e.text("Company Information:",20,80),e.setTextColor(33,33,33),e.text("IdeaWeave Project",20,90),e.text("Sreerag, Regular MCA",20,100),e.text("Amal Jyothi College of Engineering",20,110),e.text("Kottayam, Kerala, India",20,120),e.text("Email: ideaweavep@gmail.com",20,130)},Z=(e,t)=>{e.setTextColor(33,33,33),e.text("Receipt Details:",20,150);let a=[["Receipt Number",t.receiptNumber],["Amount Paid","INR ".concat((t.amountPaid/100).toFixed(2))],["Payment Status",t.paymentStatus],["Payment Date",new Date(t.paymentDate).toLocaleDateString()]];e.autoTable({startY:160,head:[["Description","Value"]],body:a,theme:"striped",margin:{top:155},styles:{textColor:[33,33,33],fontSize:12}})},W=e=>{e.line(20,e.internal.pageSize.height-20,190,e.internal.pageSize.height-20),e.text("Authorized Signature",105,e.internal.pageSize.height-10,"center")};return(0,i.jsxs)("div",{style:{textAlign:"center",marginTop:"20px"},children:[(0,i.jsx)(b,{level:2,style:{color:"dark"===a?"#fff":"D3D3D3",marginTop:"50px"},children:"Subscription"}),S?(0,i.jsxs)("div",{style:{textAlign:"center",padding:"20px",fontFamily:"Arial, sans-serif",color:"#333"},children:[(0,i.jsx)(b,{level:2,style:{color:"#1890ff",marginTop:"50px"},children:"\uD83C\uDF1F Hooray! \uD83C\uDF89"}),(0,i.jsxs)(j,{children:[(0,i.jsx)(w,{type:"warning",strong:!0,children:"Congratulations!"})," ","Your subscription is now active for",(0,i.jsxs)(w,{strong:!0,style:{color:"#1890ff"},children:[" ",null==I?void 0:I.remainingTimeInDays," days"]}),". We're excited to embark on this journey with you!."]}),A?(0,i.jsx)(f.Z,{active:!0}):I?(0,i.jsx)(o.default,{style:{maxWidth:"800px",margin:"auto",marginTop:"20px",boxShadow:"0px 4px 8px rgba(0, 0, 0, 0.1)",borderRadius:"8px",padding:"30px"},children:I.receiptDetails?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(b,{level:3,children:"Receipt Details"}),(0,i.jsxs)(g.default,{bordered:!0,column:2,children:[(0,i.jsx)(g.default.Item,{label:"Receipt Number",children:I.receiptDetails.receiptNumber}),(0,i.jsx)(g.default.Item,{label:"Amount Paid",children:(0,i.jsxs)(m.Z,{color:"green",style:{padding:"8px"},children:["₹",I.receiptDetails.amountPaid/100]})}),(0,i.jsx)(g.default.Item,{label:"Payment Status",children:I.receiptDetails.paymentStatus}),(0,i.jsx)(g.default.Item,{label:"Payment Date",children:new Date(I.receiptDetails.paymentDate).toLocaleDateString()})]}),(0,i.jsx)(c.default,{type:"primary",style:{marginTop:"20px"},onClick:()=>{let e=null==I?void 0:I.receiptDetails;if(!e)return;let t=new y.default;t.addImage("/images/Logo.png","PNG",20,10,30,30),t.setFont("times","bold"),t.setFontSize(32),t.setTextColor(33,33,33),t.text("IdeaWeave Project",60,35),t.setFontSize(18),t.text("Receipt",105,60,"center"),M(t),Z(t,e),W(t),t.save("subscription_receipt.pdf")},children:"Download Receipt"})]}):(0,i.jsx)(h.ZP,{status:"warning",title:"No receipt details available",subTitle:"Please check back later."})}):(0,i.jsx)(h.ZP,{status:"error",title:"Failed to fetch subscription details",subTitle:"Please try again later."})]}):(0,i.jsx)(l.default,{gutter:[16,16],justify:"center",children:Array.isArray(e)&&e.length>0?e.map(e=>(0,i.jsx)(s.default,{xs:24,sm:12,md:8,lg:6,children:(0,i.jsxs)(o.default,{title:(0,i.jsx)("span",{style:{color:"#000"},children:e.nickname||"Untitled Plan"}),style:{...F(),minHeight:300,display:"flex",flexDirection:"column",justifyContent:"space-between",borderRadius:"15px",boxShadow:"0px 4px 20px rgba(0, 0, 0, 0.1)",transition:"all 0.3s ease-in-out",cursor:"pointer",position:"relative",overflow:"hidden"},hoverable:!0,children:[(0,i.jsx)("div",{style:{textAlign:"center",padding:"20px"},children:(0,i.jsxs)("div",{style:{width:"180px",height:"180px",borderRadius:"50%",background:"#fff",display:"flex",justifyContent:"center",alignItems:"center",margin:"0 auto",marginBottom:"20px",boxShadow:"0px 0px 15px rgba(0, 0, 0, 0.2)",position:"relative",zIndex:1},children:[(0,i.jsxs)("span",{style:{fontSize:"28px",fontWeight:"bold",color:"#000"},children:["₹",Number(e.unit_amount/100).toFixed(2)]}),(0,i.jsx)("div",{style:{position:"absolute",width:"100%",height:"100%",borderRadius:"50%",border:"8px solid #fff",boxSizing:"border-box",position:"absolute",top:0,left:0}})]})}),(0,i.jsx)(c.default,{type:"primary",block:!0,style:{borderRadius:"0 0 15px 15px",background:"dark"===a?"#333":"#1890ff",borderColor:"dark"===a?"#333":"#1890ff",color:"#fff"},onClick:()=>N(e.id),loading:C,children:"Subscribe"})]})},e.id)):(0,i.jsx)("p",{children:"No plans available"})})]})}}},function(e){e.O(0,[7847,5584,5400,4104,1350,3740,8931,8705,9774,2888,179],function(){return e(e.s=12797)}),_N_E=e.O()}]);